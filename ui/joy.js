let StickStatus={xPosition:0,yPosition:0,x:0,y:0,cardinalDirection:"C"};var JoyStick=function(t,i,e){var n=void 0===(i=i||{}).title?"joystick":i.title,o=void 0===i.width?0:i.width,c=void 0===i.height?0:i.height,r=void 0===i.internalFillColor?"#00AA00":i.internalFillColor,a=void 0===i.internalLineWidth?2:i.internalLineWidth,d=void 0===i.internalStrokeColor?"#003300":i.internalStrokeColor,$=void 0===i.externalLineWidth?2:i.externalLineWidth,u=void 0===i.externalStrokeColor?"#008000":i.externalStrokeColor,h=void 0===i.autoReturnToCenter||i.autoReturnToCenter;e=e||function(t){};var s=document.getElementById(t);s.style.touchAction="none";var l=document.createElement("canvas");l.id=n,0===o&&(o=s.clientWidth),0===c&&(c=s.clientHeight),l.width=o,l.height=c,s.appendChild(l);var S=l.getContext("2d"),k=0,_=2*Math.PI,g=(l.width-(l.width/2+10))/2,f=g+5,x=g+30,v=l.width/2,C=l.height/2,y=l.width/10,w=-1*y,P=l.height/10,F=-1*P,E=v,L=C;function W(){S.beginPath(),S.arc(v,C,x,0,_,!1),S.lineWidth=$,S.strokeStyle=u,S.stroke()}function m(){S.beginPath(),E<g&&(E=f),E+g>l.width&&(E=l.width-f),L<g&&(L=f),L+g>l.height&&(L=l.height-f),S.arc(E,L,g,0,_,!1);var t=S.createRadialGradient(v,C,5,v,C,200);t.addColorStop(0,r),t.addColorStop(1,d),S.fillStyle=t,S.fill(),S.lineWidth=a,S.strokeStyle=d,S.stroke()}"ontouchstart"in document.documentElement?(l.addEventListener("touchstart",function t(i){k=1,R=i.targetTouches[0].identifier},!1),document.addEventListener("touchmove",function t(i){if(1===k&&i.targetTouches[0].target===l){let n=l.getBoundingClientRect();E=i.targetTouches[0].clientX-n.left,L=i.targetTouches[0].clientY-n.top,S.clearRect(0,0,l.width,l.height),W(),m(),StickStatus.xPosition=E,StickStatus.yPosition=L,StickStatus.x=(100*((E-v)/f)).toFixed(),StickStatus.y=(-(100*((L-C)/f)*1)).toFixed(),StickStatus.cardinalDirection=p(),e(StickStatus)}},!1),document.addEventListener("touchend",function t(i){i.changedTouches[0].identifier===R&&(k=0,h&&(E=v,L=C),S.clearRect(0,0,l.width,l.height),W(),m(),StickStatus.xPosition=E,StickStatus.yPosition=L,StickStatus.x=(100*((E-v)/f)).toFixed(),StickStatus.y=(-(100*((L-C)/f)*1)).toFixed(),StickStatus.cardinalDirection=p(),e(StickStatus))},!1)):(l.addEventListener("mousedown",G,!1),document.addEventListener("mousemove",function t(i){if(1===k){let n=l.getBoundingClientRect();E=i.clientX-n.left,L=i.clientY-n.top,S.clearRect(0,0,l.width,l.height),W(),m(),StickStatus.xPosition=E,StickStatus.yPosition=L,StickStatus.x=(100*((E-v)/f)).toFixed(),StickStatus.y=(-(100*((L-C)/f)*1)).toFixed(),StickStatus.cardinalDirection=p(),e(StickStatus)}},!1),document.addEventListener("mouseup",function t(i){k=0,h&&(E=v,L=C),S.clearRect(0,0,l.width,l.height),W(),m(),StickStatus.xPosition=E,StickStatus.yPosition=L,StickStatus.x=(100*((E-v)/f)).toFixed(),StickStatus.y=(-(100*((L-C)/f)*1)).toFixed(),StickStatus.cardinalDirection=p(),e(StickStatus)},!1)),W(),m();let R=null;function G(t){k=1}function p(){let t="",i=E-v,e=L-C;return e>=F&&e<=P&&(t="C"),e<F&&(t="N"),e>P&&(t="S"),i<w&&("C"===t?t="W":t+="W"),i>y&&("C"===t?t="E":t+="E"),t}this.GetWidth=function(){return l.width},this.GetHeight=function(){return l.height},this.GetPosX=function(){return E},this.GetPosY=function(){return L},this.GetX=function(){return(100*((E-v)/f)).toFixed()},this.GetY=function(){return(-(100*((L-C)/f)*1)).toFixed()},this.GetDir=function(){return p()}};